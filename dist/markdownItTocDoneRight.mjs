function e(e){return encodeURIComponent(String(e).trim().toLowerCase().replace(/\s+/g,"-"))}function n(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}export default function(r,t){var l;t=Object.assign({},{placeholder:"(\\$\\{toc\\}|\\[\\[?_?toc_?\\]?\\]|\\$\\<toc(\\{[^}]*\\})\\>)",slugify:e,uniqueSlugStartIndex:1,containerClass:"table-of-contents",containerId:void 0,containerLabel:"Table of contents",listClass:void 0,itemClass:void 0,linkClass:void 0,level:1,listType:"ol",format:void 0,callback:void 0},t);var a=new RegExp("^"+t.placeholder+"$","i");r.renderer.rules.tocOpen=function(e,r){var l=Object.assign({},t);return e&&r>=0&&(l=Object.assign(l,e[r].inlineOptions)),"<nav"+(l.containerId?' id="'+n(l.containerId)+'"':"")+' class="'+n(l.containerClass)+'" aria-label="'+n(l.containerLabel)+'">'},r.renderer.rules.tocClose=function(){return"</nav>"},r.renderer.rules.tocBody=function(e,r){var a=Object.assign({},t);e&&r>=0&&(a=Object.assign(a,e[r].inlineOptions));var i,s={},c=Array.isArray(a.level)?(i=a.level,function(e){return i.includes(e)}):function(e){return function(n){return n>=e}}(a.level);return function e(r){var l=a.listClass?' class="'+n(a.listClass)+'"':"",i=a.itemClass?' class="'+n(a.itemClass)+'"':"",o=a.linkClass?' class="'+n(a.linkClass)+'"':"";if(0===r.c.length)return"";var u="";return(0===r.l||c(r.l))&&(u+="<"+(n(a.listType)+l)+">"),r.c.forEach(function(r){c(r.l)?u+="<li"+i+"><a"+o+' href="#'+function(e){for(var n=e,r=a.uniqueSlugStartIndex;Object.prototype.hasOwnProperty.call(s,n);)n=e+"-"+r++;return s[n]=!0,n}(t.slugify(r.n))+'">'+("function"==typeof a.format?a.format(r.n,n):n(r.n))+"</a>"+e(r)+"</li>":u+=e(r)}),(0===r.l||c(r.l))&&(u+="</"+n(a.listType)+">"),u}(l)},r.core.ruler.push("generateTocAst",function(e){l=function(e){for(var n={l:0,n:"",c:[]},r=[n],t=0,l=e.length;t<l;t++){var a=e[t];if("heading_open"===a.type){var i=e[t+1].children.filter(function(e){return"text"===e.type||"code_inline"===e.type}).reduce(function(e,n){return e+n.content},""),s={l:parseInt(a.tag.substr(1),10),n:i,c:[]};if(s.l>r[0].l)r[0].c.push(s),r.unshift(s);else if(s.l===r[0].l)r[1].c.push(s),r[0]=s;else{for(;s.l<=r[0].l;)r.shift();r[0].c.push(s),r.unshift(s)}}}return n}(e.tokens),"function"==typeof t.callback&&t.callback(r.renderer.rules.tocOpen()+r.renderer.rules.tocBody()+r.renderer.rules.tocClose(),l)}),r.block.ruler.before("heading","toc",function(e,n,r,t){var l,i=e.src.slice(e.bMarks[n]+e.tShift[n],e.eMarks[n]).split(" ")[0];if(!a.test(i))return!1;if(t)return!0;var s=a.exec(i),c={};if(null!==s&&3===s.length)try{c=JSON.parse(s[2])}catch(e){}return e.line=n+1,(l=e.push("tocOpen","nav",1)).markup="",l.map=[n,e.line],l.inlineOptions=c,(l=e.push("tocBody","",0)).markup="",l.map=[n,e.line],l.inlineOptions=c,l.children=[],(l=e.push("tocClose","nav",-1)).markup="",!0},{alt:["paragraph","reference","blockquote"]})}
//# sourceMappingURL=markdownItTocDoneRight.mjs.map
